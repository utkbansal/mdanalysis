<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8.1.1. Core object: Universe — MDAnalysis.core.universe &mdash; MDAnalysis 0.16.0-dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.16.0-dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.16.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.16.0-dev0 documentation" href="../../index.html" />
    <link rel="up" title="8. Core modules" href="../core_modules.html" />
    <link rel="next" title="8.1.2. Core objects: Containers — MDAnalysis.core.groups" href="groups.html" />
    <link rel="prev" title="8. Core modules" href="../core_modules.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groups.html" title="8.1.2. Core objects: Containers — MDAnalysis.core.groups"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../core_modules.html" title="8. Core modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../core_modules.html" accesskey="U">8. Core modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.1.1. Core object: Universe &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.universe</span></code></a><ul>
<li><a class="reference internal" href="#classes">8.1.1.1. Classes</a></li>
<li><a class="reference internal" href="#functions">8.1.1.2. Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../core_modules.html"
                        title="previous chapter">8. Core modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="groups.html"
                        title="next chapter">8.1.2. Core objects: Containers &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.groups</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/core/universe.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.core.universe"></span><div class="section" id="core-object-universe-mdanalysis-core-universe">
<h1>8.1.1. Core object: Universe &#8212; <a class="reference internal" href="#module-MDAnalysis.core.universe" title="MDAnalysis.core.universe"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.core.universe</span></code></a><a class="headerlink" href="#core-object-universe-mdanalysis-core-universe" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> class ties a topology
and a trajectory together. Almost all code in MDAnalysis starts with a
<code class="docutils literal"><span class="pre">Universe</span></code>.</p>
<p>Normally, a <code class="docutils literal"><span class="pre">Universe</span></code> is created from files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;topology.psf&quot;</span><span class="p">,</span> <span class="s2">&quot;trajectory.dcd&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to construct new simulation system it is also convenient to
construct a <code class="docutils literal"><span class="pre">Universe</span></code> from existing
<code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> instances with the
<a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-func docutils literal"><span class="pre">Merge()</span></code></a> function.</p>
<div class="section" id="classes">
<h2>8.1.1.1. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.core.universe.Universe">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.universe.</code><code class="descname">Universe</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe" title="Permalink to this definition">¶</a></dt>
<dd><p>The MDAnalysis Universe contains all the information describing the system.</p>
<p>The system always requires a <em>topology</em> file &#8212; in the simplest case just
a list of atoms. This can be a CHARMM/NAMD PSF file or a simple coordinate
file with atom informations such as XYZ, PDB, Gromacs GRO, or CHARMM
CRD. See <a class="reference internal" href="../topology/init.html#supported-topology-formats"><span>Table of Supported Topology Formats</span></a> for what kind of topologies can
be read.</p>
<p>A trajectory provides coordinates; the coordinates have to be ordered in
the same way as the list of atoms in the topology. A trajectory can be a
single frame such as a PDB, CRD, or GRO file, or it can be a MD trajectory
(in CHARMM/NAMD/LAMMPS DCD, Gromacs XTC/TRR, or generic XYZ format).  See
<a class="reference internal" href="../coordinates/init.html#id1"><span>Table of supported coordinate formats</span></a> for what can be read as a
&#8220;trajectory&#8221;.</p>
<p>As a special case, when the topology is a file that contains atom
information <em>and</em> coordinates (such as XYZ, PDB, GRO or CRD, see
<a class="reference internal" href="../coordinates/init.html#id1"><span>Table of supported coordinate formats</span></a>) then the coordinates are immediately
loaded from the &#8220;topology&#8221; file unless a trajectory is supplied.</p>
<p>Examples for setting up a universe:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>          <span class="c1"># read system from file(s)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>                       <span class="c1"># read atoms and coordinates from PDB or GRO</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="p">[</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="c1"># read from a list of trajectories</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>   <span class="c1"># read from multiple trajectories</span>
</pre></div>
</div>
<p>Load new data into a universe (replaces old trajectory and does <em>not</em> append):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">load_new</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>                      <span class="c1"># read from a new trajectory file</span>
</pre></div>
</div>
<p>Select atoms, with syntax similar to CHARMM (see
<a class="reference internal" href="#MDAnalysis.core.universe.Universe.select_atoms" title="MDAnalysis.core.universe.Universe.select_atoms"><code class="xref py py-class docutils literal"><span class="pre">select_atoms</span></code></a> for details):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>topology</strong> (<em>filename or Topology object</em>) &#8211; A CHARMM/XPLOR PSF topology file, PDB file or Gromacs GRO file; used to
define the list of atoms. If the file includes bond information,
partial charges, atom masses, ... then these data will be available to
MDAnalysis. A &#8220;structure&#8221; file (PSF, PDB or GRO, in the sense of a
topology) is always required. Alternatively, an existing
<a class="reference internal" href="topology.html#MDAnalysis.core.topology.Topology" title="MDAnalysis.core.topology.Topology"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.topology.Topology</span></code></a> instance may also be given.</li>
<li><strong>topology_format</strong> &#8211; Provide the file format of the topology file; <code class="docutils literal"><span class="pre">None</span></code> guesses it from
the file extension [<code class="docutils literal"><span class="pre">None</span></code>] Can also pass a subclass of
<a class="reference internal" href="../topology/base.html#MDAnalysis.topology.base.TopologyReader" title="MDAnalysis.topology.base.TopologyReader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.topology.base.TopologyReader</span></code></a> to define a custom
reader to be used on the topology file.</li>
<li><strong>format</strong> &#8211; Provide the file format of the coordinate or trajectory file; <code class="docutils literal"><span class="pre">None</span></code>
guesses it from the file extension. Note that this keyword has no
effect if a list of file names is supplied because the &#8220;chained&#8221; reader
has to guess the file format for each individual list member.
[<code class="docutils literal"><span class="pre">None</span></code>] Can also pass a subclass of
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Reader</span></code></a> to define a custom reader
to be used on the trajectory file.</li>
<li><strong>guess_bonds</strong> &#8211; Once Universe has been loaded, attempt to guess the connectivity
between atoms.  This will populate the .bonds .angles and .dihedrals
attributes of the Universe.</li>
<li><strong>vdwradii</strong> &#8211; For use with <em>guess_bonds</em>. Supply a dict giving a vdwradii for each
atom type which are used in guessing bonds.</li>
<li><strong>is_anchor</strong> &#8211; When unpickling instances of
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> existing Universes are
searched for one where to anchor those atoms. Set to <code class="docutils literal"><span class="pre">False</span></code> to
prevent this Universe from being considered. [<code class="docutils literal"><span class="pre">True</span></code>]</li>
<li><strong>anchor_name</strong> &#8211; Setting to other than <code class="docutils literal"><span class="pre">None</span></code> will cause
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> instances pickled from the
Universe to only unpickle if a compatible Universe with matching
<em>anchor_name</em> is found. <em>is_anchor</em> will be ignored in this case but
will still be honored when unpickling
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> instances pickled with
<a href="#id1"><span class="problematic" id="id2">*</span></a>anchor_name*==``None``. [<code class="docutils literal"><span class="pre">None</span></code>]</li>
<li><strong>in_memory</strong> &#8211; After reading in the trajectory, transfer it to an in-memory
representations, which allow for manipulation of coordinates.</li>
<li><strong>in_memory_frame_interval</strong> &#8211; Only read every nth frame into in-memory representation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.trajectory">
<code class="descname">trajectory</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>currently loaded trajectory reader;</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.dimensions">
<code class="descname">dimensions</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>current system dimensions (simulation unit cell, if set in the
trajectory)</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">atoms, residues, segments</code></dt>
<dd><p>master Groups for each topology level</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">bonds, angles, dihedrals</code></dt>
<dd><p>master ConnectivityGroups for each connectivity type</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_Residue">
<code class="descname">add_Residue</code><span class="sig-paren">(</span><em>segment=None</em>, <em>**attrs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new Residue to this Universe</p>
<p>New Residues will not contain any Atoms, but can be assigned to Atoms
as per usual.  If the Universe contains multiple segments, this must
be specified as a keyword.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>segment</strong> (<em>MDAnalysis.Segment</em>) &#8211; If there are multiple segments, then the Segment that the new
Residue will belong in must be specified.</li>
<li><strong>attrs</strong> (<a class="reference external" href="http://docs.python.org/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; For each Residue attribute, the value for the new Residue must be
specified</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">A reference to the new Residue</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code> &#8211;
If any information was missing.  This happens before any changes have
been made, ie the change is rolled back.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Adding a new GLY residue, then placing atoms within it:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">newres</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">add_Residue</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resid</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">resname</span><span class="o">=</span><span class="s1">&#39;GLY&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">residues</span> <span class="o">=</span> <span class="n">newres</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname GLY and resid 42&#39;</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_Segment">
<code class="descname">add_Segment</code><span class="sig-paren">(</span><em>**attrs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_Segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new Segment to this Universe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>attrs</strong> (<a class="reference external" href="http://docs.python.org/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; For each Segment attribute as a key, give the value in the new
Segment</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A reference to the new Segment</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code> &#8211;
If any attributes were not specified as a keyword.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_TopologyAttr">
<code class="descname">add_TopologyAttr</code><span class="sig-paren">(</span><em>topologyattr</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_TopologyAttr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_TopologyAttr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new topology attribute.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.angles">
<code class="descname">angles</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Angles between atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Bonds between atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.coord">
<code class="descname">coord</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference to current timestep and coordinates of universe.</p>
<p>The raw trajectory coordinates are <code class="xref py py-attr docutils literal"><span class="pre">Universe.coord.positions</span></code>,
represented as a <code class="xref py py-class docutils literal"><span class="pre">numpy.float32</span></code> array.</p>
<p>Because <a class="reference internal" href="#MDAnalysis.core.universe.Universe.coord" title="MDAnalysis.core.universe.Universe.coord"><code class="xref py py-attr docutils literal"><span class="pre">coord</span></code></a> is a reference to a
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a>, it changes its contents
while one is stepping through the trajectory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to access the coordinates it is better to use the
<code class="xref py py-meth docutils literal"><span class="pre">AtomGroup.positions()</span></code> method; for instance, all coordinates of
the Universe as a numpy array: <code class="xref py py-meth docutils literal"><span class="pre">Universe.atoms.positions()</span></code>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.dihedrals">
<code class="descname">dihedrals</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Dihedral angles between atoms</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">dimensions</code></dt>
<dd><p>Current dimensions of the unitcell</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.impropers">
<code class="descname">impropers</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>Improper dihedral angles between atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.kwargs">
<code class="descname">kwargs</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>keyword arguments used to initialize this universe</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.load_new">
<code class="descname">load_new</code><span class="sig-paren">(</span><em>filename</em>, <em>format=None</em>, <em>in_memory=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.load_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.load_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Load coordinates from <cite>filename</cite>.</p>
<p>The file format of <cite>filename</cite> is autodetected from the file name suffix
or can be explicitly set with the <cite>format</cite> keyword. A sequence of files
can be read as a single virtual trajectory by providing a list of
filenames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str or list</em>) &#8211; the coordinate file (single frame or trajectory) <em>or</em> a list of
filenames, which are read one after another.</li>
<li><strong>format</strong> (<em>str or list or object (optional)</em>) &#8211; provide the file format of the coordinate or trajectory file;
<code class="docutils literal"><span class="pre">None</span></code> guesses it from the file extension. Note that this
keyword has no effect if a list of file names is supplied because
the &#8220;chained&#8221; reader has to guess the file format for each
individual list member [<code class="docutils literal"><span class="pre">None</span></code>]. Can also pass a subclass of
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Reader</span></code></a> to define a custom
reader to be used on the trajectory file.</li>
<li><strong>in_memory</strong> (<em>bool (optional)</em>) &#8211; <p>Directly load trajectory into memory with the
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal"><span class="pre">MemoryReader</span></code></a></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</li>
<li><strong>**kwargs</strong> &#8211; <p>Other kwargs are passed to the trajectory reader (only for
advanced use)</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li><strong>filename</strong> (<em>str or list</em>)</li>
<li><strong>trajectory_format</strong> (<em>str</em>)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><em>TypeError if trajectory format can not be</em> &#8211;
determined or no appropriate trajectory reader found</p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>If a list or sequence that is provided for <cite>filename</cite> only contains
a single entry then it is treated as single coordinate file. This
has the consequence that it is not read by the
<a class="reference internal" href="../coordinates/chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal"><span class="pre">ChainReader</span></code></a> but directly by
its specialized file format reader, which typically has more
features than the
<a class="reference internal" href="../coordinates/chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal"><span class="pre">ChainReader</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.select_atoms">
<code class="descname">select_atoms</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.select_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms.</p>
<p><a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.core.groups.AtomGroup.select_atoms()</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">trajectory</code></dt>
<dd><p>Reference to trajectory reader object containing trajectory data.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.transfer_to_memory">
<code class="descname">transfer_to_memory</code><span class="sig-paren">(</span><em>frame_interval=1</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.transfer_to_memory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.transfer_to_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer the trajectory to in memory representation.</p>
<p>Replaces the current trajectory reader object with one of type
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a> to support in-place
editing of coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame_interval</strong> (<em>int, optional</em>) &#8211; Read in every nth frame. [1]</li>
<li><strong>quiet</strong> (<em>bool, optional</em>) &#8211; Will print the progress of loading trajectory to memory, if
set to True. Default value is quiet.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions">
<h2>8.1.1.2. Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MDAnalysis.core.universe.Merge">
<code class="descclassname">MDAnalysis.core.universe.</code><code class="descname">Merge</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new new <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> from one or more
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*args</strong> &#8211; <p>One or more AtomGroups.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>universe</strong> (<a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>)</li>
<li>Raises: <code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> for too few arguments or if an AtomGroup is &#8211;
empty and <code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code> if arguments are not
<code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> instances.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The resulting <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> will only inherit the common topology
attributes that all merged universes share.</p>
<p><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> instances can come from different Universes, or can come
directly from a <a class="reference internal" href="#MDAnalysis.core.universe.Universe.select_atoms" title="MDAnalysis.core.universe.Universe.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a> call.</p>
<p><a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-class docutils literal"><span class="pre">Merge</span></code></a> can also be used with a single <code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> if the
user wants to, for example, re-order the atoms in the <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>.</p>
<p>If multiple <code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> instances from the same <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>
are given, the merge will first simply &#8220;add&#8221; together the
<code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code> instances.</p>
<p>Merging does not create a full trajectory but only a single structure even
if the input consists of one or more trajectories.  However, one can use
the <a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal"><span class="pre">MemoryReader</span></code></a> to construct a
trajectory for the new Universe as described under
<a class="reference internal" href="../coordinates/memory.html#creating-in-memory-trajectory-label"><span>Creating an in-memory trajectory of a sub-system</span></a>.</p>
<p class="rubric">Example</p>
<p>In this example, protein, ligand, and solvent were externally prepared in
three different PDB files. They are loaded into separate <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>
objects (where they could be further manipulated, e.g. renumbered,
relabeled, rotated, ...) The <a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-func docutils literal"><span class="pre">Merge()</span></code></a> command is used to combine all
of them together:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;protein.pdb&quot;</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;ligand.pdb&quot;</span><span class="p">)</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;solvent.pdb&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">u1</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">),</span> <span class="n">u2</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">u3</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;system.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The complete system is then written out to a new PDB file.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groups.html" title="8.1.2. Core objects: Containers — MDAnalysis.core.groups"
             >next</a> |</li>
        <li class="right" >
          <a href="../core_modules.html" title="8. Core modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../core_modules.html" >8. Core modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Balasubramanian, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Wouter Boomsma, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Matteo Tiberti, Isaac Virshup, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>