<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.2.6.1.4. Distance Matrix calculation — MDAnalysis.analysis.ensemble.confdistmatrix &mdash; MDAnalysis 0.16.0-dev0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.16.0-dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.16.0-dev0 documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.16.0-dev0 documentation" href="../../../index.html" />
    <link rel="up" title="3.2.6. ENCORE Ensemble Similarity Calculations — MDAnalysis.analysis.encore" href="../encore.html" />
    <link rel="next" title="3.2.6.1.5. Covariance calculation — encore.covariance" href="covariance.html" />
    <link rel="prev" title="3.2.6.1.3. Dimensionality reduction" href="dimensionality_reduction.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="covariance.html" title="3.2.6.1.5. Covariance calculation — encore.covariance"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dimensionality_reduction.html" title="3.2.6.1.3. Dimensionality reduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../analysis_modules.html" >3. Analysis modules</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../encore.html" accesskey="U">3.2.6. ENCORE Ensemble Similarity Calculations &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.encore</span></code></a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="dimensionality_reduction.html"
                        title="previous chapter">3.2.6.1.3. Dimensionality reduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="covariance.html"
                        title="next chapter">3.2.6.1.5. Covariance calculation &#8212; <code class="docutils literal"><span class="pre">encore.covariance</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/documentation_pages/analysis/encore/confdistmatrix.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.encore.confdistmatrix"></span><div class="section" id="distance-matrix-calculation-mdanalysis-analysis-ensemble-confdistmatrix">
<h1>3.2.6.1.4. Distance Matrix calculation &#8212; <code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.ensemble.confdistmatrix</span></code><a class="headerlink" href="#distance-matrix-calculation-mdanalysis-analysis-ensemble-confdistmatrix" title="Permalink to this headline">¶</a></h1>
<p>The module contains a base class to easily compute, using
parallelization and shared memory, matrices of conformational
distance between the structures stored as frames in a Universe. A
class to compute an RMSD matrix in such a way is also available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Matteo Tiberti, Wouter Boomsma, Tone Bengtsen</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2015&#8211;2016</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
<tr class="field-even field"><th class="field-name">Mantainer:</th><td class="field-body">Matteo Tiberti &lt;<a class="reference external" href="mailto:matteo&#46;tiberti&#37;&#52;&#48;gmail&#46;com">matteo<span>&#46;</span>tiberti<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;, mtiberti on github</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
<dl class="function">
<dt id="MDAnalysis.analysis.encore.confdistmatrix.conformational_distance_matrix">
<code class="descclassname">MDAnalysis.analysis.encore.confdistmatrix.</code><code class="descname">conformational_distance_matrix</code><span class="sig-paren">(</span><em>ensemble</em>, <em>conf_dist_function</em>, <em>selection=''</em>, <em>superimposition_selection=''</em>, <em>ncores=1</em>, <em>pairwise_align=True</em>, <em>mass_weighted=True</em>, <em>metadata=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/MDAnalysis/analysis/encore/confdistmatrix.html#conformational_distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.encore.confdistmatrix.conformational_distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the conformational distance matrix calculation.
args and kwargs are passed to conf_dist_function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ensemble</strong> (<em>Universe object</em>) &#8211; Universe object for which the conformational distance matrix will
be computed.</li>
<li><strong>conf_dist_function</strong> (<em>function object</em>) &#8211; Function that fills the matrix with conformational distance
values. See set_rmsd_matrix_elements for an example.</li>
<li><strong>pairwise_align</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to perform pairwise alignment between conformations.
Default is True (do the superimposition)</li>
<li><strong>mass_weighted</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to perform mass-weighted superimposition and metric
calculation. Default is True.</li>
<li><strong>metadata</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to build a metadata dataset for the calculated matrix.
Default is True.</li>
<li><strong>ncores</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of cores to be used for parallel calculation
Default is 1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>conf_dist_matrix</strong> &#8211;
Conformational distance matrix in triangular representation.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">encore.utils.TriangularMatrix object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.encore.confdistmatrix.get_distance_matrix">
<code class="descclassname">MDAnalysis.analysis.encore.confdistmatrix.</code><code class="descname">get_distance_matrix</code><span class="sig-paren">(</span><em>ensemble</em>, <em>selection='name CA'</em>, <em>load_matrix=None</em>, <em>save_matrix=None</em>, <em>superimpose=True</em>, <em>superimposition_subset='name CA'</em>, <em>mass_weighted=True</em>, <em>ncores=1</em>, <em>*conf_dist_args</em>, <em>**conf_dist_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/MDAnalysis/analysis/encore/confdistmatrix.html#get_distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.encore.confdistmatrix.get_distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves or calculates the conformational distance (RMSD)
matrix. The distance matrix is calculated between all the frames of all
the <a class="reference internal" href="../../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> objects given as input.
The order of the matrix elements depends on the order of the coordinates
of the ensembles and on the order of the input ensembles themselves,
therefore the order of the input list is significant.</p>
<p>The distance matrix can either be calculated from input ensembles or
loaded from an input numpy binary file.</p>
<p>Please notice that the .npz file does not contain a bidimensional array,
but a flattened representation that is meant to represent the elements of
an encore.utils.TriangularMatrix object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ensemble</strong> (<a class="reference internal" href="../../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) &#8211; </li>
<li><strong>selection</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Atom selection string in the MDAnalysis format. Default is &#8220;name CA&#8221;</li>
<li><strong>load_matrix</strong> (<em>str, optional</em>) &#8211; Load similarity/dissimilarity matrix from numpy binary file instead
of calculating it (default is None). A filename is required.</li>
<li><strong>save_matrix</strong> (<em>bool, optional</em>) &#8211; Save calculated matrix as numpy binary file (default is None). A
filename is required.</li>
<li><strong>superimpose</strong> (<em>bool, optional</em>) &#8211; Whether to superimpose structures before calculating distance
(default is True).</li>
<li><strong>superimposition_subset</strong> (<em>str, optional</em>) &#8211; Group for superimposition using MDAnalysis selection syntax
(default is CA atoms: &#8220;name CA&#8221;)</li>
<li><strong>mass_weighted</strong> (<em>bool, optional</em>) &#8211; calculate a mass-weighted RMSD (default is True). If set to False
the superimposition will also not be mass-weighted.</li>
<li><strong>ncores</strong> (<em>int, optional</em>) &#8211; Maximum number of cores to be used (default is 1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>confdistmatrix</strong> &#8211;
Conformational distance matrix. .</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="utils.html#MDAnalysis.analysis.encore.utils.TriangularMatrix" title="MDAnalysis.analysis.encore.utils.TriangularMatrix">encore.utils.TriangularMatrix</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.encore.confdistmatrix.pbar_updater">
<code class="descclassname">MDAnalysis.analysis.encore.confdistmatrix.</code><code class="descname">pbar_updater</code><span class="sig-paren">(</span><em>pbar</em>, <em>pbar_counters</em>, <em>max_val</em>, <em>update_interval=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/MDAnalysis/analysis/encore/confdistmatrix.html#pbar_updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.encore.confdistmatrix.pbar_updater" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that updates and prints the progress bar, upon polling
progress status from workers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pbar</strong> (<em>encore.utils.AnimatedProgressBar object</em>) &#8211; Progress bar object</li>
<li><strong>pbar_counters</strong> (<em>list of multiprocessing.RawValue</em>) &#8211; List of counters. Each worker is given a counter, which is updated
at every cycle. In this way the _pbar_updater process can
asynchronously fetch progress reports.</li>
<li><strong>max_val</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Total number of matrix elements to be calculated</li>
<li><strong>update_interval</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Number of seconds between progress bar updates</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.encore.confdistmatrix.set_rmsd_matrix_elements">
<code class="descclassname">MDAnalysis.analysis.encore.confdistmatrix.</code><code class="descname">set_rmsd_matrix_elements</code><span class="sig-paren">(</span><em>tasks</em>, <em>coords</em>, <em>rmsdmat</em>, <em>masses</em>, <em>fit_coords=None</em>, <em>fit_masses=None</em>, <em>pbar_counter=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/MDAnalysis/analysis/encore/confdistmatrix.html#set_rmsd_matrix_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.encore.confdistmatrix.set_rmsd_matrix_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>RMSD Matrix calculator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tasks</strong> (<em>iterator of int of length 2</em>) &#8211; <p>Given a triangular matrix, this function will calculate RMSD
values from element tasks[0] to tasks[1]. Since the matrix
is triangular, the trm_indeces matrix automatically
calculates the corrisponding i,j matrix indices.
The matrix is written as an array in a row-major
order (see the TriangularMatrix class for details).</p>
<p>If fit_coords and fit_masses are specified, the structures
will be superimposed before calculating RMSD, and fit_coords and fit_masses
will be used to place both structures at their center of mass and
compute the rotation matrix. In this case, both fit_coords and fit_masses
must be specified.</p>
</li>
<li><strong>coords</strong> (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.11)"><em>numpy.array</em></a>) &#8211; Array of the ensemble coordinates</li>
<li><strong>masses</strong> (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.11)"><em>numpy.array</em></a>) &#8211; Array of atomic masses, having the same order as the
coordinates array</li>
<li><strong>rmsdmat</strong> (<a class="reference internal" href="utils.html#MDAnalysis.analysis.encore.utils.TriangularMatrix" title="MDAnalysis.analysis.encore.utils.TriangularMatrix"><em>encore.utils.TriangularMatrix</em></a>) &#8211; Memory-shared triangular matrix object</li>
<li><strong>fit_coords</strong> (<em>numpy.array or None</em>) &#8211; Array of the coordinates used for fitting</li>
<li><strong>fit_masses</strong> (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.11)"><em>numpy.array</em></a>) &#8211; Array of atomic masses, having the same order as the
fit_coords array</li>
<li><strong>pbar_counter</strong> (<em>multiprocessing.RawValue</em>) &#8211; Thread-safe shared value. This counter is updated at
every cycle and used to evaluate the progress of
each worker in a parallel calculation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="covariance.html" title="3.2.6.1.5. Covariance calculation — encore.covariance"
             >next</a> |</li>
        <li class="right" >
          <a href="dimensionality_reduction.html" title="3.2.6.1.3. Dimensionality reduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../analysis_modules.html" >3. Analysis modules</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../encore.html" >3.2.6. ENCORE Ensemble Similarity Calculations &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.encore</span></code></a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Balasubramanian, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Wouter Boomsma, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Matteo Tiberti, Isaac Virshup, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>